<title>AU_ALL</title><body style="font-family:sans-serif;background:#222;color:#eee">
<b>AU MASTER LOCATOR</b><br>
<input id=Q oninput=S() placeholder="Search 15,000+ towns..." style="width:90%;padding:8px;margin:5px 0">
<p id=M style="font-size:12px">Offline Mode Active</p>
<div id=R></div><script>
// Data Format: "Name,LatDiff,LonDiff" 
// We use a giant string and split it. This is faster than JSON for 15k entries.
D="Sydney,0,0|Melbourne,-394,-625|Sunbury,25,10|Wagga,269,241|Perth,586,-3151"; // This string would hold the 15k towns
T=[]; l=0; o=0;
D.split('|').map(x=>{
  [n,da,do_]=x.split(',');
  l+=parseInt(da)/100; o+=parseInt(do_)/100; // Delta decoding
  T.push({n,la:l.toFixed(2),lo:o.toFixed(2)});
});

S=()=>{
  q=Q.value.toLowerCase(); R.innerHTML='';
  if(q.length<3) return;
  f=T.filter(x=>x.n.toLowerCase().includes(q)).slice(0,20);
  M.innerText=f.length?`Found ${f.length} (showing top 20)`:'No matches';
  f.map(x=>R.innerHTML+=`<div style="background:#333;padding:10px;margin-bottom:2px;border-left:4px solid #007aff">
    <b>${x.n}</b><br><code style="color:#0f0">${x.la}, ${x.lo}</code>
    <button onclick="C(${x.la},${x.lo})" style="float:right">Dist</button></div>`);
};

// Distance logic for survival navigation
C=(la,lo)=>{
  navigator.geolocation.getCurrentPosition(p=>{
    y=p.coords;
    R=6371; dLa=(la-y.latitude)*Math.PI/180; dLo=(lo-y.longitude)*Math.PI/180;
    a=Math.sin(dLa/2)**2+Math.cos(y.latitude*Math.PI/180)*Math.cos(la*Math.PI/180)*Math.sin(dLo/2)**2;
    d=R*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));
    alert(`Distance to ${la},${lo}: ${d.toFixed(1)} km`);
  });
};
</script>
